# 聊天网页平台 - 使用说明

## 项目概述

这是一个功能完整的Web聊天平台，支持用户注册登录、公共频道聊天、群聊功能以及完善的管理员后台系统。

## 主要功能

### 1. 用户系统
- **注册方式**：用户名 + 密码 + 手机号 + 短信验证码 + 邀请码
- **登录方式**：
  - 用户名 + 密码登录
  - 手机号 + 短信验证码登录

### 2. 聊天功能
- **公共频道**：所有登录用户可以在公共频道中实时交流
- **群聊功能**：
  - 创建群聊（可设置密码保护）
  - 加入群聊（需要密码的群聊需输入正确密码）
  - 群聊消息实时更新
  - 所有群聊在"发现群聊"中可见
  - 查看群成员
  - 退出群聊
- **好友系统**：
  - 搜索并添加好友（输入用户名）
  - 接受/拒绝好友申请
  - 好友列表管理
  - 删除好友
  - 好友申请会在公共频道显示系统提示

### 3. 内容安全
- **违禁词检测**：
  - 自动检测消息中的违禁词
  - 包含违禁词的消息会被自动拦截
  - 系统记录违规行为
  - 管理员收到违规通知（在公共频道显示）

### 4. 管理员后台
- **用户管理**：
  - 查看所有用户
  - 修改用户角色（普通用户/管理员/超级管理员/封禁/禁言）
  - 封禁/解封用户账号（封禁后自动踢下线）
  - 禁言/解除禁言（禁言用户可登录但不能发消息）
  - 踢用户下线（强制退出登录）
  - 删除用户（同时删除认证账号和用户资料）
  - 批量删除用户（支持多选）
  - **创建用户（仅超级管理员）**：直接创建用户账号，无需邀请码和短信验证
- **邀请码管理**：
  - 生成新邀请码
  - 查看邀请码使用状态
- **违规管理**：
  - 查看违规记录（用户、违禁词、原内容、时间）
  - 管理违禁词列表
  - 添加/删除违禁词
- **超级管理员专属**：
  - 重置所有数据（清空所有用户和业务数据，但保留超级管理员账号）

### 5. 个人设置
- **个人信息**：查看用户名、手机号、角色
- **修改密码**：更新登录密码（至少6个字符）

### 6. 个人中心
- **基本信息**：修改用户名和手机号
- **修改密码**：更新登录密码
- **账号信息**：查看角色和注册时间

## 快速开始

### 第一步：注册管理员账号

1. 访问注册页面
2. 填写以下信息：
   - 用户名：Admin（或其他您喜欢的用户名，只能包含字母、数字和下划线）
   - 密码：zyz150908666（或其他密码，至少6位）
   - 确认密码：再次输入密码
   - 手机号：您的手机号
   - 短信验证码：点击"发送验证码"获取，然后点击"验证手机号"按钮
   - 邀请码：**WELCOME2025**（初始邀请码，全大写）

3. 确保手机号已验证（显示"已验证 ✓"）
4. 点击"注册"完成注册

**重要提示**：
- 第一个注册的用户将自动成为管理员！
- 邀请码必须全大写：WELCOME2025
- 必须先验证手机号才能完成注册

### 第二步：生成更多邀请码

1. 使用管理员账号登录
2. 进入"管理后台"
3. 切换到"邀请码管理"标签
4. 点击"生成邀请码"按钮
5. 将生成的邀请码分享给其他用户

### 第三步：开始聊天

1. 点击"公共频道"进入公共聊天室
2. 或者点击"群聊"创建/加入群聊
3. 点击"好友"添加好友
4. 开始与其他用户交流！

### 第四步：使用新功能

#### 添加好友
1. 进入"好友"页面
2. 点击"添加好友"按钮
3. 输入对方的用户名
4. 点击"发送申请"
5. 对方会在好友页面看到申请，同时公共频道会显示系统提示
6. 对方接受后即可成为好友

#### 创建密码保护的群聊
1. 进入"群聊"页面
2. 点击"创建群聊"
3. 填写群聊名称和描述
4. 在"群聊密码"字段输入密码（留空表示无密码）
5. 点击"创建"
6. 其他用户在"发现群聊"中可以看到该群聊，但需要输入正确密码才能加入

#### 管理违禁词（管理员）
1. 进入"管理后台"
2. 切换到"违禁词"标签
3. 点击"添加违禁词"添加新的违禁词
4. 点击违禁词旁边的删除按钮可以删除
5. 用户发送包含违禁词的消息会被自动拦截
6. 系统会在公共频道通知管理员

#### 查看违规记录（管理员）
1. 进入"管理后台"
2. 切换到"违规记录"标签
3. 查看所有用户的违规行为记录

#### 封禁/解封用户（管理员）
1. 进入"管理后台"
2. 在"用户管理"标签中
3. 点击用户旁边的"封禁"按钮封禁用户
4. 被封禁的用户会自动退出登录，无法再次登录
5. 点击"解封"按钮可以恢复用户权限

#### 禁言/解除禁言（管理员）
1. 进入"管理后台"
2. 在"用户管理"标签中
3. 点击用户旁边的"禁言"按钮禁言用户
4. 被禁言的用户可以登录和浏览，但无法发送消息
5. 点击"解除禁言"按钮可以恢复发言权限

#### 踢用户下线（管理员）
1. 进入"管理后台"
2. 在"用户管理"标签中
3. 点击用户旁边的"踢下线"按钮
4. 用户会立即被强制退出登录
5. 用户可以重新登录（除非被封禁）

#### 重置所有数据（仅超级管理员）
1. 进入"管理后台"
2. 点击右上角的"重置所有数据"按钮
3. 在第一个确认对话框中点击"确认重置"
4. 系统将清空所有用户数据、消息、群聊、好友关系等
5. 超级管理员账号会被保留
6. 重置完成后自动刷新页面

#### 批量删除用户（管理员）
1. 进入"管理后台"
2. 在"用户管理"标签中
3. 勾选要删除的用户（可以点击表头复选框全选）
4. 点击右上角的"批量删除"按钮
5. 在确认对话框中点击"确认删除"
6. 系统将删除所选用户的所有数据

#### 修改密码
1. 点击侧边栏或底部导航的"设置"
2. 在"修改密码"卡片中输入新密码（至少6个字符）
3. 再次输入新密码确认
4. 点击"修改密码"按钮
5. 修改成功后会显示提示

#### 创建用户（仅超级管理员）
1. 进入"管理后台"
2. 在"用户管理"标签中，点击右上角的"创建用户"按钮
3. 填写用户信息：
   - 用户名（必填，只能包含字母、数字和下划线）
   - 密码（必填，至少6个字符）
   - 手机号（可选，11位手机号）
   - 角色（必选：普通用户/管理员/超级管理员）
4. 点击"创建"按钮
5. 创建成功后用户可以直接登录

#### 个人中心
1. 点击右上角用户头像
2. 在下拉菜单中选择"个人中心"
3. 在"基本信息"卡片中可以修改：
   - 用户名（会同步更新登录邮箱）
   - 手机号
4. 在"修改密码"卡片中可以更新密码
5. 在"账号信息"卡片中查看角色和注册时间

## 技术特点

### 设计风格
- **主色调**：蓝色系 (#4A90E2)
- **背景色**：浅灰色 (#F8F9FA)
- **圆角设计**：8px圆角，轻微阴影效果
- **布局**：左侧导航 + 主内容区（桌面端）
- **响应式**：完美适配桌面和移动设备

### 技术栈
- **前端框架**：React + TypeScript
- **UI组件**：shadcn/ui + Tailwind CSS
- **后端服务**：Supabase（数据库 + 认证 + Edge Functions）
- **路由管理**：React Router
- **状态管理**：React Context + Hooks

### 安全特性
- 基于Supabase Auth的用户认证
- Row Level Security (RLS) 数据权限控制
- 短信验证码验证
- 邀请码系统防止恶意注册
- 管理员权限分级管理
- 违禁词自动检测和拦截
- 用户封禁机制
- 违规行为记录和追踪

## 页面导航

### 公开页面
- `/login` - 登录页面
- `/register` - 注册页面

### 需要登录的页面
- `/` - 首页（功能导航）
- `/public-chat` - 公共频道
- `/groups` - 群聊列表
- `/groups/:groupId` - 群聊详情
- `/friends` - 好友管理
- `/settings` - 个人设置
- `/profile` - 个人中心

### 管理员专属页面
- `/admin` - 管理后台（包含用户管理、邀请码、违规记录、违禁词管理）

## 常见问题

### Q: 如何成为管理员？
A: 第一个注册的用户自动成为管理员。其他用户需要由管理员在后台手动提升权限。

### Q: 超级管理员和普通管理员有什么区别？
A: 超级管理员拥有所有管理员权限，并且额外拥有"重置所有数据"的功能。只有超级管理员可以设置其他用户为超级管理员。

### Q: 忘记密码怎么办？
A: 可以使用手机号 + 短信验证码登录。

### Q: 如何获取邀请码？
A: 联系管理员获取邀请码，或使用初始邀请码 WELCOME2025（仅限第一个用户）。

### Q: 被封禁后还能登录吗？
A: 不能。被封禁的用户会自动退出登录，且无法再次登录。

### Q: 被禁言和被封禁有什么区别？
A: 被禁言的用户可以登录和浏览内容，但无法发送消息。被封禁的用户会被强制退出登录，且无法再次登录。

### Q: 被踢下线后还能登录吗？
A: 可以。被踢下线只是强制退出当前登录，用户可以重新登录（除非被封禁）。

### Q: 消息是实时的吗？
A: 消息通过轮询方式每3秒自动刷新，接近实时效果。用户状态检查每5秒执行一次。

### Q: 如何创建有密码的群聊？
A: 在创建群聊时，在"群聊密码"字段输入密码即可。留空表示无密码。

### Q: 如何添加好友？
A: 进入"好友"页面，点击"添加好友"，输入对方的用户名发送申请。

### Q: 发送的消息被拦截了怎么办？
A: 您的消息可能包含违禁词。请修改消息内容后重新发送。

### Q: 管理员如何查看违规记录？
A: 进入管理后台，切换到"违规记录"标签即可查看所有违规行为。

## 开发信息

- **项目名称**：聊天网页平台
- **开发时间**：2025年
- **版本**：1.0.0

## 联系支持

如有任何问题或建议，请联系管理员。
